<!DOCTYPE html>
<html lang="en" style="height: 100%;">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.32.1/min/vs/editor/editor.main.min.css"
    integrity="sha512-zNEMnMjqQJTh1FYoL84ldT9sMKBN4cMu1fTOKJiB23d7wYDht8Bn0XLu6F4sh9i9VV1s8QjYn8UlGw+SR/KLHw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <title>Regex101 C# PoC</title>
  <base href="/BlazorAppRegex/" />
  <link rel="icon" type="image/x-icon" href="/BlazorAppRegex/favicon.ico">
  <script>
    window.addEventListener("load", () => {
      window.editor = monaco.editor.create(document.getElementById('container'), {
        value: ['{}'].join('\n'),
        language: 'json'
      });
    });
  </script>
</head>

<body style="height: 100%;">
  <div id="app">Loading...</div>
  <div id="flex-container" style="display: none; height: 100%">
    <div id="try" style="flex: 1;height: 100%">
      <table>
        <tr>
          <td><label>Regex:</label></td>
          <td><input id="regex" type="text" value="." style="width: 100%;font-family: monospace;" /></td>
        </tr>
        <tr>
          <td><label>Text:</label></td>
          <td><textarea id="value" type="text" value="Some value 123 with number" cols="60" rows="10">a</textarea></td>
        </tr>
        <tr>
          <td><label>Substitution:</label></td>
          <td><input id="substitution" type="text" value="b" style="width: 100%;font-family: monospace;" />
          </td>
        </tr>
        <tr>
          <td colpan="2"><button id="regex-matches" style="width:max-content">Regex matches</button></td>
        </tr>
        <tr>
          <td colpan="2"><button id="regex-match" style="width:max-content">Regex match</button></td>
        </tr>
        <tr>
          <td colpan="2"><button id="regex-substitution" style="width:max-content">Regex substituion</button>
          </td>
        </tr>
        <tr>
          <td colpan="2"><button id="regex-list-substitution" style="width:max-content">Regex list substituion</button>
          </td>
        </tr>
        <tr>
          <td id="elapsed" colpan="2">
        </tr>
      </table>
    </div>
    <div id="container" style="flex: 1;min-width: 800px; min-height: 600px; border: 1px solid grey"></div>
  </div>

  <script>
    const myBlazorWorker = new Worker('blazorWebWorker.js');
    window.myBlazorWorker = myBlazorWorker;
    myBlazorWorker.addEventListener('message', (e) => {
      const strJson = e.data;
      performance.mark("after");
      performance.measure("Total", "before", "after");
      document.getElementById("elapsed").textContent = `Evaluated in: ${performance.getEntriesByType("measure")[0].duration}ms`;
      const json = strJson && strJson.indexOf('{') !== -1
        ? JSON.stringify((JSON.parse(strJson)), null, 2)
        : strJson;
      window.editor.setValue(json);
      performance.clearMarks();
      performance.clearMeasures();
      performance.clearResourceTimings();
    })
    document.querySelector("#app").remove();
    document.querySelector("#flex-container").style.display = "flex";
    const regexElement = document.querySelector("#regex");
    const valueElement = document.querySelector("#value");
    const substitutionElement = document.querySelector("#substitution");

    document.querySelector("#regex-matches").addEventListener("click", () => {
      performance.mark("before");
      window.myBlazorWorker.postMessage(JSON.stringify({ method: "globalMatches", regex: regexElement.value, textValue: valueElement.value }))
    });
    document.querySelector("#regex-match").addEventListener("click", () => {
      performance.mark("before");
      window.myBlazorWorker.postMessage(JSON.stringify({ method: "oneMatch", regex: regexElement.value, textValue: valueElement.value }))
    });
    document.querySelector("#regex-substitution").addEventListener("click", () => {
      performance.mark("before");
      window.myBlazorWorker.postMessage(JSON.stringify({ method: "substitution", regex: regexElement.value, textValue: valueElement.value, substitution: substitutionElement.value }))
    });
    document.querySelector("#regex-list-substitution").addEventListener("click", () => {
      performance.mark("before");
      window.myBlazorWorker.postMessage(JSON.stringify({ method: "listSubstitution", regex: regexElement.value, textValue: valueElement.value, substitution: substitutionElement.value }))
    });
  </script>
  <script>
    var require = { paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.32.1/min/vs' } };
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.32.1/min/vs/loader.min.js"
    integrity="sha512-O9SYDgWAM3bEzit1z6mkFd+dxKUplO/oB8UwYGAkg2Zy/WzDUQ2mYA/ysk3c0CxiXAN4u8T9JeZ0Ahk2Jj/33Q=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.32.1/min/vs/editor/editor.main.nls.min.js"
    integrity="sha512-RBJMO+2Jx4onKLqQIADPuWIVjoc7AJXsOht63iSKCPIxelX/+3SJAH1BKfmCBMUVJdsZPxNbLDQfje0QZMz75A=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.32.1/min/vs/editor/editor.main.js"
    integrity="sha512-q5FuwQfPfkE43pDXeLPh0CGl0WPAnQtfoCFFbyInQlPeYvQCiq+C7LsrNAnntYJRgNZ62+nBgjhQdOmEwLu/GA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>

</html>